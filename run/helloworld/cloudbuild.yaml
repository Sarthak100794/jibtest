steps: 
  - id: "run bashh"
    name: 'gcr.io/cloud-builders/gcloud'
    entrypoint: "bash"
    args:
      - "-c"
      - |
          ls
     
  - id: 'build your instance'
    name: 'maven:3.6.0-jdk-11-slim'
    entrypoint: mvn
    args: ['clean','package','-Dmaven.test.skip=true']
    dir: "run/helloworld"
  
  - id: "run bashhhhhh"
    name: 'gcr.io/cloud-builders/gcloud'
    entrypoint: "bash"
    args:
      - "-c"
      - |
          cd run
          ls
  - id: Generate manifest
    name: 'gcr.io/cloud-builders/gcloud'
    entrypoint: /bin/sh
    args:
    - '-c'
    - |
     sed "s/nginx/tomcat/g" src/deployment.yaml 
 
  - id: Deploy
    name: 'gcr.io/cloud-builders/kubectl'  
    args:
    - 'apply'
    - '-f'
    - 'src/deployment.yaml'
    env:
    - 'CLOUDSDK_COMPUTE_REGION=us-central1'
    - 'CLOUDSDK_CONTAINER_CLUSTER=cluster-1'
  - id: "run bashhhhhhhh"
    name: 'gcr.io/cloud-builders/gcloud'
    entrypoint: "bash"
    args:
      - "-c"
      - |
          cd run
          cd helloworld
          cd source
          cd main
          ls    
 # - id: 'Deploy image to kubernetes'
 #   name: 'gcr.io/cloud-builders/gke-deploy'
 #   args:
 #   - run
 #   - --filename=./run/helloworld/src
 #   - --location=us-central1
 #   - --cluster=cluster-1
   
     
